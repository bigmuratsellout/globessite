<!DOCTYPE html>
<html>
<head>
  <style> body { margin: 0; } </style>

  <script type="importmap">{ "imports": {
    "three": "https://esm.sh/three",
    "three/": "https://esm.sh/three/"
  }}</script>
</head>

<body>
  <div id="globeViz"></div>

  <script type="module">
    import ThreeGlobe from 'https://esm.sh/three-globe?external=three';
    import * as THREE from 'https://esm.sh/three';
    import { TrackballControls } from 'three/examples/jsm/controls/TrackballControls.js?external=three';

    // Initialize the globe
    const Globe = new ThreeGlobe()
      .globeImageUrl('//unpkg.com/three-globe/example/img/earth-blue-marble.jpg')
      .bumpImageUrl('//unpkg.com/three-globe/example/img/earth-topology.png');

    // Setup renderer
    const renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.getElementById('globeViz').appendChild(renderer.domElement);

    // Setup scene
    const scene = new THREE.Scene();
    scene.add(Globe);
    scene.add(new THREE.AmbientLight(0xcccccc, Math.PI));
    scene.add(new THREE.DirectionalLight(0xffffff, 0.6 * Math.PI));

    // Setup camera
    const camera = new THREE.PerspectiveCamera();
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    camera.position.z = 500;

    // Add TrackballControls
    const controls = new TrackballControls(camera, renderer.domElement);
    controls.rotateSpeed = 1.0; // Adjust rotation speed
    controls.zoomSpeed = 1.2; // Adjust zoom speed
    controls.panSpeed = 0.8; // Adjust pan speed
    controls.noZoom = false; // Allow zooming
    controls.noPan = false; // Allow panning
    controls.staticMoving = true; // Smoother movement
    controls.dynamicDampingFactor = 0.3; // Add damping for smoother controls

    // Enable auto-rotation
    controls.autoRotate = true;
    controls.autoRotateSpeed = 0.5; // Adjust auto-rotation speed

    // Kick-off renderer
    (function animate() {
      controls.update(); // Update controls (required for auto-rotation)
      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    })();
  </script>
</body>
</html>
